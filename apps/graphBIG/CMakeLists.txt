project(VL_uBMK)

cmake_minimum_required(VERSION 3.1)
include_directories(common openG)

find_package(OpenMP QUIET)
if (OPENMP_FOUND)
  add_microbenchmark(tc_omp bench_tc.cpp)
  target_compile_definitions(tc_omp PRIVATE -DUSE_OMP -DNO_PFM)
  target_compile_options(tc_omp PRIVATE ${OpenMP_C_FLAGS})
  target_link_libraries(tc_omp ${OpenMP_C_FLAGS})

  add_microbenchmark(dc_omp bench_dc.cpp)
  target_compile_definitions(dc_omp PRIVATE -DUSE_OMP -DNO_PFM)
  target_compile_options(dc_omp PRIVATE ${OpenMP_C_FLAGS})
  target_link_libraries(dc_omp ${OpenMP_C_FLAGS})
  if (RaftLib_FOUND)
      add_raftbenchmark(tc_rl rl_tc.cpp)
      target_compile_definitions(tc_rl PRIVATE -DUSE_OMP -DNO_PFM)
      target_compile_options(tc_rl PRIVATE ${OpenMP_C_FLAGS})
      target_link_libraries(tc_rl ${OpenMP_C_FLAGS})

      add_raftbenchmark(dc_rl rl_dc.cpp)
      target_compile_definitions(dc_rl PRIVATE -DUSE_OMP -DNO_PFM)
      target_compile_options(dc_rl PRIVATE ${OpenMP_C_FLAGS})
      target_link_libraries(dc_rl ${OpenMP_C_FLAGS})
  else()
      MESSAGE(STATUS "WARNING: No RaftLib, skip tc_rl, dc_rl.")
  endif()
else()
  MESSAGE(STATUS "WARNING: No openmp library, skip graphBIG benchmarks.")
endif()
